View(m_factor)
m_factor <- lapply(m_factor, ordered) %>% as_tibble()
data_males <- cbind(data_males$CASE, m_factor, data_males$attr) %>% mutate(attr  = case_when(`data_males$attr` == 0 ~ "no attraction", `data_males$attr` > 0 ~ "some attraction"))
View(data_males)
data_males <- data_males %>% select(-`data_males$attr`)
data_males <- data_males %>% mutate(attr = attr %>% ordered())
colnames(data_males)[1]<-"CASE"
View(data_males)
#Clean up
rm(m_factor)
desc_m <- tidySEM::descriptives(data_males %>% select(-CASE))
desc_m <- desc_m %>% select(name, type, n, missing, unique, mode, mode_value, v)
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
data_males <- mutate(data_males, across(everything(), as.factor))
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
View(data_males)
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=CSBD:attr, names_to="var", values_to="score")
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score", values_transform=list(score=as.factor))
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score", values_transform=list(score=as.numeric))
View(plotd_m)
knitr::opts_chunk$set(echo=F, warning=F, message=F)
#For reproducible results
set.seed(100)
#Turn off scientific notification
options(scipen=999)
#Declare vector of required packages
packages <- c("tidyverse", "readr", "ggpubr", "flextable")
#Load function to check whether required packages are installed & load required packages
source("./functions/check_required_packages.R")
check_required_packages(packages)
lapply(packages, require, character.only=T)
#Clean up
rm(packages)
#######ATTENTION!!!
#At this point we load a pre-saved .RData file in which the environment is saved. That makes the code less reproducible, but removing the eval=F specifications in all code blocks will make that possible
load(".RData")
data_males <- haven::read_spss("./data/data raw/dataE_2112.sav") %>% dplyr::select(gender, CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr) %>% filter(gender == 2) %>% dplyr::select(-gender)
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score", values_transform=list(score=as.numeric))
#######ATTENTION!!!
#At this point we load a pre-saved .RData file in which the environment is saved. That makes the code less reproducible, but removing the eval=F specifications in all code blocks will make that possible
load(".RData")
#We use gender instead of sex. A 2 represents a male. We want to only grab males.
data_males <- haven::read_spss("./data/data raw/dataE_2112.sav") %>% dplyr::select(gender, CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr) %>% filter(gender == 2) %>% dplyr::select(-gender)
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
View(plotd_m)
#######ATTENTION!!!
#At this point we load a pre-saved .RData file in which the environment is saved. That makes the code less reproducible, but removing the eval=F specifications in all code blocks will make that possible
load(".RData")
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
View(data_males)
str(data_males$sexdrive2)
View(data_males)
#We use gender instead of sex. A 2 represents a male. We want to only grab males.
data_males <- haven::read_spss("./data/data raw/dataE_2112.sav") %>% dplyr::select(gender, CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr) %>% filter(gender == 2) %>% dplyr::select(-gender)
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
#create long data frame for plotting, including only the relevant variables
plotd_m <- data_males %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
#create a table with the quantiles for each variable
quant_m <- as.data.frame(t(do.call(rbind.data.frame, (lapply(c("CSBD", "lon", "meffort", "mvalue", "PPCS_6", "sexdrive2", "socialanx"), function(x){parse_number(gsub(",.*$", "", levels(cut_number(as.data.frame(data_males)[, x], 4))))})))))
#rename columns
colnames(quant_m) <- c("CSBD", "lon", "meffort", "mvalue", "PPCS_6", "sexdrive2", "socialanx")
#pivot for plotting
quant_m <- pivot_longer(quant_m, cols=CSBD:socialanx, names_to='var')
#call on function in other R script
source("./functions/flat_violin.R")
#plot
g1 <- ggplot(plotd_m %>% filter(var!="attr"), aes(x=as.factor(var), y=score, fill=var)) +
geom_flat_violin(scale="width") +
scale_fill_grey(start=.5, end=.9, aesthetics = "fill") +
geom_dotplot(binaxis="y", dotsize=.04, stackdir="down", binwidth=.3, position=position_nudge(-.025)) +
geom_errorbar(data=quant_m, aes(x=as.factor(var), ymin=value, ymax=value, linetype="quantiles"), inherit.aes=F, linewidth=.5, width=.3, position=position_nudge(x=.15)) +
scale_linetype_manual(values="solid") +
guides(linetype=guide_legend(""), fill="none") +
scale_x_discrete(labels=c("CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Embodied capital", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="", y="value") +
theme_classic() +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
#plot attraction to children separately
g2 <- ggplot(plotd_m %>% filter(var=="attr"), aes(x=score)) +
geom_bar() +
theme_classic() +
labs(x="Sexual interest in children", y="count")
#arrange plots
ggarrange(g1, g2, ncol=2, nrow=1, widths=c(1.6, 1))
#arrange plots
ggarrange(g1, g2, ncol=1, nrow=2, widths=c(1.6, 1))
#plot
ggplot(plotd_m %>% filter(var!="attr"), aes(x=as.factor(var), y=score, fill=var)) +
geom_flat_violin(scale="width") +
scale_fill_grey(start=.5, end=.9, aesthetics = "fill") +
geom_dotplot(binaxis="y", dotsize=.04, stackdir="down", binwidth=.3, position=position_nudge(-.025)) +
geom_errorbar(data=quant_m, aes(x=as.factor(var), ymin=value, ymax=value, linetype="quantiles"), inherit.aes=F, linewidth=.5, width=.3, position=position_nudge(x=.15)) +
scale_linetype_manual(values="solid") +
guides(linetype=guide_legend(""), fill="none") +
scale_x_discrete(labels=c("CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Mating value", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="", y="Value") +
theme_classic() +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
#plot
ggplot(plotd_m %>% filter(var!="attr"), aes(x=as.factor(var), y=score, fill=var)) +
geom_flat_violin(scale="width") +
scale_fill_grey(start=.5, end=.9, aesthetics = "fill") +
geom_dotplot(binaxis="y", dotsize=.04, stackdir="down", binwidth=.3, position=position_nudge(-.025)) +
geom_errorbar(data=quant_m, aes(x=as.factor(var), ymin=value, ymax=value, linetype="Quantiles"), inherit.aes=F, linewidth=.5, width=.3, position=position_nudge(x=.15)) +
scale_linetype_manual(values="solid") +
guides(linetype=guide_legend(""), fill="none") +
scale_x_discrete(labels=c("CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Mating value", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="", y="Value") +
theme_classic() +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
#plot attraction to children separately
ggplot(plotd_m %>% filter(var=="attr"), aes(x=score)) +
geom_bar() +
theme_classic() +
labs(x="Sexual interest in children", y="Count")
BCH_results_parameters %>% select(outcomes, starts_with("b") & ends_with("0.01"))
BCH_results_parameters %>% select(starts_with("b") & ends_with("0.01"))
BCH_results_parameters %>% select(starts_with("b") & ends_with("0.01"))[1]
BCH_results_parameters %>% select(starts_with("b") & ends_with("0.01")[1])
results <- data.frame(Proclivity = c("Chat with a child", "Chat with a young person", "Drive under influence", "Make a gift to a child", "Make a gift to a young person", "Kill someone", "Watch CSEM", "Watch CSEM on the darknet", "Watch porn with a young person", "Have sex with a prostitute", "Watch porn in public", "Rape someone", "Rob a bank", "Have sex with a child", "Have sex with a young person", "Drive over the speed limit", "Have sex with an animal"), "Reference category"=c(BCH_results_parameters %>% select(starts_with("b") & ends_with("0.01")[1])), "Class 1"=c(BCH_results_parameters %>% select(starts_with("b") & ends_with("0.01")[2])), "Class 2"=c(BCH_results_parameters %>% select(starts_with("b") & ends_with("0.01")[3])))
View(results)
results <- cbind(Proclivity = c("Chat with a child", "Chat with a young person", "Drive under influence", "Make a gift to a child", "Make a gift to a young person", "Kill someone", "Watch CSEM", "Watch CSEM on the darknet", "Watch porn with a young person", "Have sex with a prostitute", "Watch porn in public", "Rape someone", "Rob a bank", "Have sex with a child", "Have sex with a young person", "Drive over the speed limit", "Have sex with an animal"), BCH_results_parameters %>% select(outcomes, starts_with("b") & ends_with("0.01"), starts_with("p") & ends_with("0.01")))
View(results)
BCH_results_parameters %>% select(starts_with("ci") & ends_with("0.01")
)
results <- cbind(Proclivity = c("Chat with a child", "Chat with a young person", "Drive under influence", "Make a gift to a child", "Make a gift to a young person", "Kill someone", "Watch CSEM", "Watch CSEM on the darknet", "Watch porn with a young person", "Have sex with a prostitute", "Watch porn in public", "Rape someone", "Rob a bank", "Have sex with a child", "Have sex with a young person", "Drive over the speed limit", "Have sex with an animal"), BCH_results_parameters %>% select(ends_with("total_0.01"), starts_with("b") & ends_with("0.01"), starts_with("p") & ends_with("0.01"), starts_with("ci") & ends_with("0.01")))
?col_keys
?flextable
flextable(results) %>%
col_keys(p_lr_total_0.01, b_intercept_0.01, ci_l_intercept_0.01, ci_r_intercept_0.01, p_lr_intercept_0.01, b_predicted_class_1_0.01, ci_l_predicted_class_1_0.01, ci_r_predicted_class_1_0.01, p_lr_predicted_class_1_0.01, b_predicted_class_2_0.01, ci_l_predicted_class_2_0.01, ci_r_predicted_class_2_0.01, p_lr_predicted_class_2_0.01) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2", colwidths=c(1, 1, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
library(flextable)
flextable(results) %>%
col_keys(p_lr_total_0.01, b_intercept_0.01, ci_l_intercept_0.01, ci_r_intercept_0.01, p_lr_intercept_0.01, b_predicted_class_1_0.01, ci_l_predicted_class_1_0.01, ci_r_predicted_class_1_0.01, p_lr_predicted_class_1_0.01, b_predicted_class_2_0.01, ci_l_predicted_class_2_0.01, ci_r_predicted_class_2_0.01, p_lr_predicted_class_2_0.01) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2", colwidths=c(1, 1, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c(p_lr_total_0.01, b_intercept_0.01, ci_l_intercept_0.01, ci_r_intercept_0.01, p_lr_intercept_0.01, b_predicted_class_1_0.01, ci_l_predicted_class_1_0.01, ci_r_predicted_class_1_0.01, p_lr_predicted_class_1_0.01, b_predicted_class_2_0.01, ci_l_predicted_class_2_0.01, ci_r_predicted_class_2_0.01, p_lr_predicted_class_2_0.01)) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2", colwidths=c(1, 1, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2", colwidths=c(1, 1, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01"))
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2))
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p")
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2", colwidths=c(1, 1, 4, 4, 4)))
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c(".", "Global", "Reference", "Class 1", "Class 2", colwidths=c(1, 1, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("Global", "Reference", "Class 1", "Class 2", colwidths=c(2, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_lines(values=c("Global", "Reference", "Class 1", "Class 2", colwidths=c(2, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header(values=c("Global", "Reference", "Class 1", "Class 2", colwidths=c(2, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("Global", "Reference", "Class 1", "Class 2", colwidths=c(2, 4, 4, 4))) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2"), colwidths=c(2, 4, 4, 4)) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2"), colwidths=c(1, 1, 4, 4, 4)) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("Proclivity", "p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2"), colwidths=c(1, 1, 4, 4, 4)) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("Proclivity", "p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_intercept_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_1_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_2_0.01=function(x) apa(x, decimals=3, leading=F),) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2"), colwidths=c(1, 1, 4, 4, 4)) %>%
theme_booktabs() %>%
autofit()
library(MOTE)
flextable(results, col_keys=c("Proclivity", "p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_intercept_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_1_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_2_0.01=function(x) apa(x, decimals=3, leading=F),) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2"), colwidths=c(1, 1, 4, 4, 4)) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("Proclivity", "p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_intercept_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_1_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_2_0.01=function(x) apa(x, decimals=3, leading=F)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2"), colwidths=c(1, 1, 4, 4, 4)) %>%
theme_booktabs() %>%
autofit()
flextable(results, col_keys=c("Proclivity", "p_lr_total_0.01", "b_intercept_0.01", "ci_l_intercept_0.01", "ci_r_intercept_0.01", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "ci_l_predicted_class_1_0.01", "ci_r_predicted_class_1_0.01", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "ci_l_predicted_class_2_0.01", "ci_r_predicted_class_2_0.01", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(p_lr_total_0.01=function(x) apa(x, decimals=3, leading=F),
b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_intercept_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_1_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_l_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
ci_r_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_2_0.01=function(x) apa(x, decimals=3, leading=F)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", ci_l_intercept_0.01="CI lower", ci_r_intercept_0.01="CI upper", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", ci_l_predicted_class_1_0.01="CI lower", ci_r_predicted_class_1_0.01="CI upper", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", ci_l_predicted_class_2_0.01="CI lower", ci_r_predicted_class_2_0.01="CI upper", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2"), colwidths=c(1, 1, 4, 4, 4)) %>%
theme_booktabs() %>%
autofit()
paste0("[", results$ci_l_intercept_0.01, ", ", results$ci_r_intercept_0.01, "]")
results$CI_intercept <- paste0("[", results$ci_l_intercept_0.01, ", ", results$ci_r_intercept_0.01, "]")
results$CI_intercept <- paste0("[", format(round(exp(results$ci_l_intercept_0.01), 2), nsmall=2), ", ", format(round(exp(results$ci_r_intercept_0.01), 2), nsmall=2), "]")
results$CI_class1 <- paste0("[", format(round(exp(results$ci_l_predicted_class_1_0.01), 2), nsmall=2), ", ", format(round(exp(results$ci_r_predicted_class_1_0.01), 2), nsmall=2), "]")
results$CI_class2 <- paste0("[", format(round(exp(results$ci_l_predicted_class_2_0.01), 2), nsmall=2), ", ", format(round(exp(results$ci_r_predicted_class_2_0.01), 2), nsmall=2), "]")
flextable(results, col_keys=c("Proclivity", "p_lr_total_0.01", "b_intercept_0.01", "CI_intercept", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "CI_class1", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "CI_class2", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(p_lr_total_0.01=function(x) apa(x, decimals=3, leading=F),
b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_intercept_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_1_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_2_0.01=function(x) apa(x, decimals=3, leading=F)) %>%
set_header_labels(p_lr_total_0.01="", b_intercept_0.01="OR", CI_intercept="CI", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", CI_class1="CI", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", CI_class2="CI", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global", "Reference", "Class 1", "Class 2"), colwidths=c(1, 1, 3, 3, 3)) %>%
theme_booktabs() %>%
autofit()
#Put relevant results in a table
results <- cbind(Proclivity = c("Chat with a child", "Chat with a young person", "Drive under influence", "Make a gift to a child", "Make a gift to a young person", "Kill someone", "Watch CSEM", "Watch CSEM on the darknet", "Watch porn with a young person", "Have sex with a prostitute", "Watch porn in public", "Rape someone", "Rob a bank", "Have sex with a child", "Have sex with a young person", "Drive over the speed limit", "Have sex with an animal"), BCH_results_parameters %>% select(ends_with("total_0.01"), starts_with("b") & ends_with("0.01"), starts_with("p") & ends_with("0.01"), starts_with("ci") & ends_with("0.01")))
#Create extra columns with CIs
results$CI_intercept <- paste0("[", format(round(exp(results$ci_l_intercept_0.01), 2), nsmall=2), ", ", format(round(exp(results$ci_r_intercept_0.01), 2), nsmall=2), "]")
results$CI_class1 <- paste0("[", format(round(exp(results$ci_l_predicted_class_1_0.01), 2), nsmall=2), ", ", format(round(exp(results$ci_r_predicted_class_1_0.01), 2), nsmall=2), "]")
results$CI_class2 <- paste0("[", format(round(exp(results$ci_l_predicted_class_2_0.01), 2), nsmall=2), ", ", format(round(exp(results$ci_r_predicted_class_2_0.01), 2), nsmall=2), "]")
#Pretty output
flextable(results, col_keys=c("Proclivity", "p_lr_total_0.01", "b_intercept_0.01", "CI_intercept", "p_lr_intercept_0.01", "b_predicted_class_1_0.01", "CI_class1", "p_lr_predicted_class_1_0.01", "b_predicted_class_2_0.01", "CI_class2", "p_lr_predicted_class_2_0.01")) %>%
set_formatter(p_lr_total_0.01=function(x) apa(x, decimals=3, leading=F),
b_intercept_0.01=function(x) format(round(exp(x), 2), nsmall=2), #transform into OR with exp()
p_lr_intercept_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_1_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_1_0.01=function(x) apa(x, decimals=3, leading=F),
b_predicted_class_2_0.01=function(x) format(round(exp(x), 2), nsmall=2),
p_lr_predicted_class_2_0.01=function(x) apa(x, decimals=3, leading=F)) %>%
set_header_labels(p_lr_total_0.01="p", b_intercept_0.01="Odds", CI_intercept="CI", p_lr_intercept_0.01="p", b_predicted_class_1_0.01="OR", CI_class1="CI", p_lr_predicted_class_1_0.01="p", b_predicted_class_2_0.01="OR", CI_class2="CI", p_lr_predicted_class_2_0.01="p") %>%
add_header_row(values=c("", "Global LRT", "(Intercept)", "Class 1", "Class 2"), colwidths=c(1, 1, 3, 3, 3)) %>%
theme_booktabs() %>%
autofit()
plot(lca_fit)
#Make table presentable
prob_table_LCA_m$Variable <- c(rep(c("Sex drive", "CSBD-7", "PPCS-6", "Mating effort", "Social anxiety", "LON", "Mating value", "Sexual interest in children"), each=4))[1:nrow(prob_table_LCA_m)]
#Pretty display
flextable(prob_table_LCA_m) %>%
set_formatter(Probability.class1=function(x) format(round(x, 2), nsmall=2),
Probability.class2=function(x) format(round(x, 2), nsmall=2),
Probability.class3=function(x) format(round(x, 2), nsmall=2)) %>%
set_header_labels(Probability.class1="Class 1", Probability.class2="Class 2", Probability.class3="Class 3") %>%
theme_booktabs() %>%
autofit()
plot_prob(lca_final_model_m) +
scale_fill_grey(start = 0.9, end = 0.5, aesthetics = "fill") +
scale_x_discrete(labels=c("attr"="Sexual interest in children", "CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Mating value", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="") +
theme_classic() +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
#Do not show code chunks in the knitted document
knitr::opts_chunk$set(echo=F, warning=F, message=F)
#For reproducible results
set.seed(100)
#Turn off scientific notification
options(scipen=999)
#Declare vector of required packages
packages <- c("tidyverse", "readr", "tidySEM", "MOTE", "flextable", "logistf")
#Load function to check whether required packages are installed & load required packages
source("./functions/check_required_packages.R")
check_required_packages(packages)
lapply(packages, require, character.only=T)
#Clean up
rm(packages)
#######ATTENTION!!!
#At this point we load a pre-saved .RData file in which the environment is saved. That makes the code less reproducible, but removing the eval=F specifications in all code blocks will make that possible
load(".RData")
plot_prob(lca_final_model_m) +
scale_fill_grey(start = 0.9, end = 0.5, aesthetics = "fill") +
scale_x_discrete(labels=c("attr"="Sexual interest in children", "CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Mating value", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="") +
theme_classic() +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
plot_prob(lca_final_model_m) +
scale_fill_grey(start = 0.9, end = 0.5, aesthetics = "fill") +
scale_x_discrete(labels=c("attr"="Sexual interest in children", "CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Mating value", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="") +
theme_classic() +
theme(axis.text.x=element_text(angle=80, hjust=1, size=10))
plot_prob(lca_final_model_m) +
scale_fill_grey(start = 0.9, end = 0.5, aesthetics = "fill") +
scale_x_discrete(labels=c("attr"="Sexual interest in children", "CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Mating value", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="") +
theme_classic() +
theme(axis.text.x=element_text(angle=70, hjust=1, size=10))
plot_prob(lca_final_model_m) +
scale_fill_grey(start = 0.9, end = 0.5, aesthetics = "fill") +
scale_x_discrete(labels=c("attr"="Sexual interest in children", "CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Mating value", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="") +
theme_classic() +
theme(axis.text.x=element_text(angle=60, hjust=1, size=10))
plot_prob(lca_final_model_m) +
scale_fill_grey(start = 0.9, end = 0.5, aesthetics = "fill") +
scale_x_discrete(labels=c("attr"="Sexual interest in children", "CSBD"="CSBD-7", "lon"="LON", "meffort"="Mating effort", "mvalue"="Mating value", "PPCS_6"="PPCS-6", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="") +
theme_classic() +
theme(axis.text.x=element_text(angle=70, hjust=1, size=10))
