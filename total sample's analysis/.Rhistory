readRDS("C:/Users/gniel/OneDrive - MSB Medical School Berlin/Project special issue/LPA_analysis/out/LPA_full_data.RDS")
lpa <- readRDS("C:/Users/gniel/OneDrive - MSB Medical School Berlin/Project special issue/LPA_analysis/out/LPA_full_data.RDS")
View(lpa)
knitr::opts_chunk$set(echo = TRUE)
lpa_models <- readRDS("C:/Users/gniel/OneDrive - MSB Medical School Berlin/Project special issue/LPA_analysis/out/lpa_models.RDS")
View(lpa_models)
lpa_model_eval <- readRDS("C:/Users/gniel/OneDrive - MSB Medical School Berlin/Project special issue/LPA_analysis/out/lpa_model_eval.RDS")
View(lpa_model_eval)
lpa$data %>% view()
library(tidyverse)
lpa$data %>% view()
#Results from the OPTICS clustering.
optics_models <- readRDS("C:/Users/gniel/OneDrive - MSB Medical School Berlin/Project special issue/LPA_analysis/out/optics_models.RDS")
View(optics_models)
View(lpa)
lpa
summary(lpa)
library(mclust)
summary(lpa)
#Results from the Latent Profile Analysis of the whole sample is imported from the saved RDS files.
lpa_full_data <- readRDS("C:/Users/gniel/OneDrive - MSB Medical School Berlin/Project special issue/LPA_analysis/out/LPA_full_data.RDS")
rm(lpa)
save.image("C:/Users/gniel/OneDrive - MSB Medical School Berlin/Project special issue/LPA_analysis/total sample's analysis/.RData")
#load the results from the optics clustering
optics_models <- readRDS("C:/Users/Rebecca/Documents/GitHub/LPA_analysis/out/optics_models.RDS")
#load data
data <- haven::read_spss("./data/data raw/dataE_clear5 2209.sav") %>% select(CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr)
colnames(data) <- c("uid", "sex_drive", "csbd", "ppcs", "soi_r_me", "social_anxiety", "lon", "mvs", "attraction_to_children")
library(tidyverse)
#load data
data <- haven::read_spss("./data/data raw/dataE_clear5 2209.sav") %>% select(CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr)
colnames(data) <- c("uid", "sex_drive", "csbd", "ppcs", "soi_r_me", "social_anxiety", "lon", "mvs", "attraction_to_children")
predict(newdata=data[data$uid %in% (optics_models[i,] %>% pull(test_fold_uids) %>%unlist()),] %>% select(-uid),
object =optics_models$DBSCAN_clustering[[i]],
data = data[optics_models$folds[[i]],] %>% select(-uid))}))
save.image("C:/Users/Rebecca/Documents/GitHub/LPA_analysis/total sample's analysis/.RData")
#Load RData file
load("./.RData")
#Do not show code chunks in the knitted document
knitr::opts_chunk$set(echo=F, warning=F, message=F)
#Declare vector of required packages
packages <- c("tidyverse", "readr")
#Load function to check whether required packages are installed & load required packages
source("./functions/check_required_packages.R")
check_required_packages(packages)
lapply(packages, require, character.only=T)
#Clean up
rm(packages)
##DATA##
data <- haven::read_spss("./data/data raw/dataE_clear5 2209.sav") %>% dplyr::select(CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr)
#create long data frame for plotting, including only the relevant variables
plotd_all <- data %>% select(CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr) %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
#create a table with the quantiles for each variable (except CSBD & PPCS_6)
quant <- as.data.frame(t(do.call(rbind.data.frame, (lapply(c("lon", "meffort", "mvalue", "sexdrive2", "socialanx"), function(x){parse_number(gsub(",.*$", "", levels(cut_number(as.data.frame(data_females)[, x], 4))))})))))
#create long data frame for plotting, including only the relevant variables
plotd_all <- data %>% select(CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr) %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
#create a table with the quantiles for each variable (except CSBD & PPCS_6)
quant <- as.data.frame(t(do.call(rbind.data.frame, (lapply(c("lon", "meffort", "mvalue", "sexdrive2", "socialanx"), function(x){parse_number(gsub(",.*$", "", levels(cut_number(as.data.frame(data)[, x], 4))))})))))
#call on function
source("./functions/flat_violin.R")
#plot
ggplot(plotd_all %>% filter(var!="attr"), aes(x=as.factor(var), y=score, fill=var)) +
geom_flat_violin(scale="width") +
scale_fill_grey(start=.5, end=.9, aesthetics = "fill") +
geom_dotplot(binaxis="y", dotsize=.04, stackdir="down", binwidth=.3, position=position_nudge(-.025)) +
guides(fill="none") +
scale_x_discrete(labels=c("CSBD"="Compulsive sex.", "lon"="Loneliness", "meffort"="Mating effort", "mvalue"="Mate value", "PPCS_6"="Probl. porn use", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="", y="Value") +
theme_classic() +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
#plot attraction to children separately
ggplot(plotd_all %>% filter(var=="attr"), aes(x=score)) +
geom_bar() +
theme_classic() +
labs(x="Attraction to children", y="Count")
#Load RData file
load("./.RData")
#Do not show code chunks in the knitted document
knitr::opts_chunk$set(echo=F, warning=F, message=F)
#Declare vector of required packages
packages <- c("tidyverse", "readr")
#Load function to check whether required packages are installed & load required packages
source("./functions/check_required_packages.R")
check_required_packages(packages)
lapply(packages, require, character.only=T)
#Clean up
rm(packages)
##DATA##
data <- haven::read_spss("./data/data raw/dataE_clear5 2209.sav") %>% dplyr::select(CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr)
#create long data frame for plotting, including only the relevant variables
plotd_all <- data %>% select(CASE, sexdrive2, CSBD, PPCS_6, meffort, socialanx, lon, mvalue, attr) %>% pivot_longer(cols=sexdrive2:attr, names_to="var", values_to="score")
#call on function
source("./functions/flat_violin.R")
#plot
ggplot(plotd_all %>% filter(var!="attr"), aes(x=as.factor(var), y=score, fill=var)) +
geom_flat_violin(scale="width") +
scale_fill_grey(start=.5, end=.9, aesthetics = "fill") +
geom_dotplot(binaxis="y", dotsize=.04, stackdir="down", binwidth=.3, position=position_nudge(-.025)) +
guides(fill="none") +
scale_x_discrete(labels=c("CSBD"="Compulsive sex.", "lon"="Loneliness", "meffort"="Mating effort", "mvalue"="Mate value", "PPCS_6"="Probl. porn use", "sexdrive2"="Sex drive", "socialanx"="Social anxiety")) +
labs(x="", y="Value") +
theme_classic() +
theme(axis.text.x=element_text(angle=45, hjust=1, size=10))
#plot attraction to children separately
ggplot(plotd_all %>% filter(var=="attr"), aes(x=score)) +
geom_bar() +
theme_classic() +
labs(x="Attraction to children", y="Count")
